---
title: "Analiza danych w R"
output:
  workflowr::wflow_html:
    toc: false
editor_options:
  chunk_output_type: console
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(ggplot2)
library(dplyr)
library(knitr)
library(plotly)
```

# **Opis zbioru danych**

Analizuję klasyczny zbiór danych *iris*, który zawiera pomiary morfologiczne trzech gatunków irysów.
Jest to jeden z najpopularniejszych zbiorów w statystyce i uczeniu maszynowym.

**Źródło**: Edgar Anderson *(dane zebrane na półwyspie Gaspé)*.

**Liczba obserwacji**: 150.

**Liczba zmiennych**: 5.

***Zmienne w zbiorze***:

-   Sepal.Length – długość działki kielicha (cm).
-   Sepal.Width – szerokość działki kielicha (cm).
-   Petal.Length – długość płatka (cm).
-   Petal.Width – szerokość płatka (cm).
-   Species – gatunek kwiatu (setosa, versicolor, virginica).

## **Przekształcenia danych z dplyr**

```{r}
# Ładowanie danych
data(iris)
iris_data <- as_tibble(iris)

# 1. Filtrowanie - wybieramy kwiaty o długości działki kielicha powyżej 5.0
iris_filtered <- iris_data %>%
  filter(Sepal.Length > 5.0)

# 2. Mutate - dodanie stosunku długości płatka do jego szerokości
iris_transformed <- iris_filtered %>%
  mutate(Petal.Ratio = Petal.Length / Petal.Width)

# 3. Group_by i summarise - średnie wymiary według gatunku
iris_summary <- iris_transformed %>%
  group_by(Species) %>%
  summarise(
    mean_sepal_length = mean(Sepal.Length, na.rm = TRUE),
    mean_petal_length = mean(Petal.Length, na.rm = TRUE),
    count = n()
  ) %>%
  arrange(desc(mean_sepal_length))

# Podgląd wyników
kable(iris_summary, caption = "Podsumowanie średnich wymiarów według gatunku")
```

# **Wizualizacje**

## **Wykres słupkowy** – Średnia długość płatka według gatunku

```{r bar_chart}
#| echo: false
#| fig-height: 4

ggplot(iris_summary, aes(x = reorder(Species, mean_petal_length), y = mean_petal_length, fill = Species)) +
  geom_bar(stat = "identity", color = 'black') +
  geom_text(aes(label = round(mean_petal_length, 1)), vjust = -0.5) +
  labs(
    title = "Średnia długość płatka dla poszczególnych gatunków",
    x = "Gatunek",
    y = "Średnia długość płatka (cm)",
    caption = "Dane: zbiór iris"
  ) +
  theme_minimal() +
  theme(legend.position = "none")
```

**Komentarz**: Gatunek virginica charakteryzuje się zdecydowanie najdłuższymi płatkami, podczas gdy setosa posiada płatki najkrótsze.

## **Wykres punktowy** – Zależność szerokości od długości płatka

```{r scatter_plot}
#| echo: false
#| fig-height: 4

ggplot(iris_data, aes(x = Petal.Length, y = Petal.Width, color = Species)) +
  geom_point(size = 2, alpha = 0.7) +
  geom_smooth(method = "lm", se = FALSE, linetype = "dashed") +
  labs(
    title = "Zależność między szerokością a długością płatka",
    x = "Długość płatka (cm)",
    y = "Szerokość płatka (cm)",
    subtitle = "Z podziałem na gatunki i linią trendu"
  ) +
  theme_light()
```

**Komentarz**: Istnieje silna dodatnia korelacja między długością a szerokością płatka.
Wykres wyraźnie separuje gatunek setosa od pozostałych dwóch.

## **Boxplot** – Rozkład długości działki kielicha

```{r box_plot}
#| echo: false
#| fig-height: 4

ggplot(iris_data, aes(x = Species, y = Sepal.Length, fill = Species)) +
  geom_boxplot(alpha = 0.6) +
  labs(
    title = "Rozkład długości działki kielicha (Sepal Length)",
    x = "Gatunek",
    y = "Długość (cm)"
  ) +
  scale_fill_brewer(palette = "Set2") +
  theme_minimal() +
  theme(legend.position = "none")
```

**Komentarz**: Virginica wykazuje największą zmienność i najwyższe wartości długości działki kielicha, natomiast setosa jest gatunkiem o najbardziej skupionych i najniższych wartościach.

## **Podsumowanie**

Analiza zbioru iris wykazała, że:

-   Gatunki można łatwo odróżnić na podstawie wymiarów płatków (Petal).

-   Występuje silna korelacja liniowa między wymiarami płatków u wszystkich gatunków.

-   Iris virginica jest gatunkiem o największych gabarytach, a Iris setosa o najmniejszych.

-   Analiza demonstruje wykorzystanie pakietów dplyr do obróbki danych oraz ggplot2 do zaawansowanej wizualizacji statystycznej.
